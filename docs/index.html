<!DOCTYPE HTML>
<html lang="de">

<head>
  <title>Timeline | Basic demo</title>
  <meta charset="utf-8" />
  <style type="text/css">
    body,
    html {
      font-family: sans-serif;
    }
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.20.1/vis.js"></script>
  <script src="jquery-3.2.1.min.js"></script>
  <script src="myjs.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.20.1/vis.css" rel="stylesheet" type="text/css" />
</head>

<body>
  <h1>Camera 2016 </h1>
  <div id="visualization"></div>
  <h2> Ausge√§hltes Interval </h2>
  <div id="disp_selected">Please select an interval.</div>

  <script type="text/javascript">
    // DOM element where the Timeline will be attached
    $.ajaxSetup({
      async: false
    });

    var JSON_PATH_ECC_0 = 'Cam_0_intervals_ecc_extended.json';
    var JSON_PATH_ECC_1 = 'Cam_1_intervals_ecc_extended.json';
    var JSON_PATH_ECC_2 = 'Cam_2_intervals_ecc_extended.json';
    var JSON_PATH_ECC_3 = 'Cam_3_intervals_ecc_extended.json';

    var JSON_PATH_TIME_0 = 'Cam_0_intervals_time.json';
    var JSON_PATH_TIME_1 = 'Cam_1_intervals_time.json';
    var JSON_PATH_TIME_2 = 'Cam_2_intervals_time.json';
    var JSON_PATH_TIME_3 = 'Cam_3_intervals_time.json';

    var JSON_PATH_MAINTANCE = "maintenance_info.json";


    var PATHS_ECC = [JSON_PATH_ECC_0, JSON_PATH_ECC_1, JSON_PATH_ECC_2, JSON_PATH_ECC_3]
    var PATHS_TIME = [JSON_PATH_TIME_0, JSON_PATH_TIME_1, JSON_PATH_TIME_2, JSON_PATH_TIME_3]

    var dsply_json = [];
    PATHS_ECC.forEach(function(json_path, i){
      var curJson;
      var group = 'ecc_' + i;
      $.getJSON(json_path, function(json) {
        curJson = json
      });
      curJson.forEach(function(item, j){
        dsply_json.push(createSafeInterval(item, dsply_json.length, group))
      })
    });

    PATHS_TIME.forEach(function(json_path, i){
      var curJson;
      var group = 'time_' + i;
      $.getJSON(json_path, function(json) {
        curJson = json
      });
      curJson.forEach(function(item, j){
        dsply_json.push(createTimeInterval(item, dsply_json.length, group))
      })
    });

    var curJson;
    $.getJSON(JSON_PATH_MAINTANCE, function(json) {
      curJson = json
      console.log(curJson)
    });
    curJson.forEach(function(item, j){
      var adj_item = item
      adj_item["group"] = "maintenance_info"
      dsply_json.push(adj_item)
    });

    var groups = new vis.DataSet();
    groups.add([
      { "id":"maintenance_info",
        "content": "maintenance"
      },
      {
        "id": "ecc_0",
        "content": 'Cam_0 (ecc)',
        "nestedGroups": ["time_0"],
        "showNested":false
      },
      {
        "id": "time_0",
        "content": 'Cam_0 (time)',
      },
      {
        "id": "ecc_1",
        "content": 'Cam_1 (ecc)',
        "nestedGroups": ["time_1"],
        "showNested":false
        // Optional: a field 'className', 'style', 'order', [properties]
      },
      {
        "id": "time_1",
        "content": 'Cam_1 (time)'
      },
      {
        "id": "ecc_2",
        "content": 'Cam_2 (ecc)',
        "nestedGroups": ["time_2"],
        "showNested":false
        // Optional: a field 'className', 'style', 'order', [properties]
      },
      {
        "id": "time_2",
        "content": 'Cam_2 (time)',
      },
      {
        "id": "ecc_3",
        "content": 'Cam_3 (ecc)',
        "nestedGroups": ["time_3"],
        "showNested":false
        // Optional: a field 'className', 'style', 'order', [properties]
      },
      {
        "id": "time_3",
        "content": 'Cam_3 (time)',
      }
    ]);
    // groups.add(groups_data)
    var options = {
      "stack": false
    };

    var container = document.getElementById('visualization');
    var items = new vis.DataSet(dsply_json);
    var timeline = new vis.Timeline(container, items, groups, options);
    timeline.on('select', function (properties) {
        var item1 = items.get(properties.items);
        var group = properties.groups
        console.log(group)
        var curr_container = document.getElementById('disp_selected')
        curr_container.innerHTML = item1[0]["title"]
        // document.write(item1[0]["title"])
      });
  </script>
</body>

</html>
